# Oracle RAG AI Agent - Dialogflow OpenAPI Spec

openapi: 3.0.0
info:
  title: Oracle RAG AI Agent API
  version: 1.0.0
  description: |
    REST API for Retrieval-Augmented Generation using Oracle Database 23ai 
    vector storage and Google Vertex AI Gemini LLM.
    
    This API provides intelligent question-answering grounded in Oracle Database 
    technical documentation stored as vectors in Oracle Database 23ai.
  contact:
    name: Oracle AI Team
    email: support@oracle.com

servers:
  - url: http://34.48.146.146:8080
    description: GCP VM Production
  - url: http://localhost:8080
    description: Local Development

paths:
  /api/v1/query:
    post:
      summary: Query the RAG system
      description: |
        Submit a question to retrieve relevant context from Oracle Database 23ai 
        vector store and generate an answer using Vertex AI Gemini LLM.
      operationId: queryRag
      tags:
        - RAG
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - question
              properties:
                question:
                  type: string
                  description: The user's question to be answered
                  example: "Tell me more about JSON Relational Duality"
      responses:
        '200':
          description: Successfully generated response
          content:
            application/json:
              schema:
                type: object
                properties:
                  answer:
                    type: string
                    description: The generated answer based on retrieved context
                    example: "JSON Relational Duality in Oracle Database 23ai allows you to work with data as both JSON documents and relational tables..."
                  source:
                    type: string
                    description: Source of the information
                    example: "Oracle Database 23ai Vector RAG"
                  responseTimeMs:
                    type: integer
                    description: Time taken to generate response in milliseconds
                    example: 1250
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/health:
    get:
      summary: Health check
      description: Check if the RAG service is healthy and database connection is working
      operationId: healthCheck
      tags:
        - Health
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum: [UP, DOWN]
                    example: UP
                  timestamp:
                    type: string
                    format: date-time
                    example: "2026-01-09T10:30:00Z"
        '503':
          description: Service is unavailable
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: DOWN
                  timestamp:
                    type: string
                    format: date-time

components:
  schemas:
    Error:
      type: object
      properties:
        error:
          type: string
          description: Error message
          example: "Failed to connect to Oracle Database"
        status:
          type: integer
          description: HTTP status code
          example: 500
        timestamp:
          type: string
          format: date-time
          description: Timestamp of the error
          example: "2026-01-09T10:30:00Z"
